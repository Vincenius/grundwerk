---
import Layout from "../../layouts/Layout.astro";
import Footer from "../../components/Footer.astro";
import { Image } from "astro:assets";
import header from "../../assets/products-bg.jpg";
import Navbar from "../../components/Navbar.astro";
import { products } from "../../data/products";
---

<Layout>
  <header class="relative">
    <Navbar />
    <div class="header-bg absolute z-[-1]">
      <Image src={header} alt="abstract background" />
    </div>
    <h1 class="text-6xl font-thin">Products</h1>
  </header>

  <main>
    <section id="products-section" class="py-20 relative bg-white">
      <div class="w-full max-w-2xl lg:max-w-7xl px-6 lg:px-8 mx-auto">
        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8 gap-y-16"
        >
          {
            products.map((product, idx) => {
              return (
                <a href={product.link} data-product-card class={`group flex items-center flex-col gap-4 w-full`}>
                  <div class="block w-full">
                    <img
                      class="rounded-3xl object-cover w-full h-[260px]"
                      src={product.image}
                      alt={`Project Achievements of ${product.name}`}
                    />
                  </div>
                  <div class="flex items-center justify-between max-w-[406px] lg:max-w-full w-full lg:px-0">
                    <div class="block">
                      <p class="font-medium text-lg text-gray-400">
                        {product.brand}
                      </p>
                      <h2 class="text-2xl font-manrope font-semibold text-gray-900 mb-1">
                        {product.name}
                      </h2>
                    </div>

                    <button class="border border-black py-2 px-3.5 rounded-full transition-all duration-300 group-hover:bg-black">
                      <svg
                        class="stroke-black transition-all duration-300 group-hover:stroke-white"
                        xmlns="http://www.w3.org/2000/svg"
                        width="17"
                        height="16"
                        viewBox="0 0 17 16"
                        fill="none"
                      >
                        <path
                          d="M9.62553 4L13.6664 8.0409M13.6664 8.0409L9.62553 12.0818M13.6664 8.0409L1.6665 8.0409"
                          stroke=""
                          stroke-width="1.6"
                          stroke-linecap="round"
                        />
                      </svg>
                    </button>
                  </div>
                </a>
              );
            })
          }
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>
<style>
  header {
    height: 100%;
    min-height: 50vh;
  }

  .header-bg img {
    object-position: center;
  }
  .header-bg::after {
    content: "";
    opacity: 0.8;
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    background: #fff;
  }
</style>
<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  window.addEventListener("DOMContentLoaded", () => {
    const cards = document.querySelectorAll("[data-product-card]");

    gsap.set(cards, { opacity: 0, y: 150 });

    ScrollTrigger.batch(cards, {
      start: "top 85%",
      onEnter: batch => {
        gsap.to(batch, {
          opacity: 1,
          y: 0,
          duration: 1,
          stagger: 0.08,
          ease: "power2.out"
        });
      },
      once: true
    });
  });
</script>
