---
import { products } from '../data/products'
---

<section class="relative my-40" id="products-section">
  <h1
    class="font-bold text-4xl mb-20 text-center font-thin opacity-0"
    id="products-heading"
  >
    Our Products
  </h1>
  <div
    class="w-fit mx-auto grid grid-cols-1 lg:grid-cols-3 md:grid-cols-2 justify-items-center justify-center gap-y-20 gap-x-14 mt-10 mb-5"
  >
    {
      products.map((product, idx) => (
        <div
          class="w-72 bg-white shadow-md rounded-xl duration-500 hover:scale-105 hover:shadow-xl opacity-0"
          data-product-card
        >
          <a href={product.link}>
            <img
              src={product.image}
              alt="Product"
              class="h-80 w-72 object-cover rounded-t-xl"
            />
            <div class="px-4 py-3 w-72">
              <span class="text-gray-400 mr-3 uppercase text-xs">{product.brand}</span>
              <p class="text-lg font-bold text-black truncate block capitalize">
                {product.name}
              </p>
            </div>
          </a>
        </div>
      ))
    }
  </div>
  <div class="flex justify-center mt-20">
    <a
      href="/products"
      class="inline-block px-8 py-3 bg-black text-white font-semibold rounded-full shadow-lg hover:bg-gray-800 transition-colors duration-300 text-lg"
    >
      Show all products
    </a>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  window.addEventListener("DOMContentLoaded", () => {
    const section = document.getElementById("products-section");
    const heading = document.getElementById("products-heading");
    const cards = section.querySelectorAll("[data-product-card]");

    gsap.set(heading, { opacity: 0, y: 40 });
    gsap.set(cards, { opacity: 0, y: 40 });

    ScrollTrigger.create({
      trigger: section,
      start: "top 80%",
      onEnter: () => {
        gsap.to(heading, {
          opacity: 1,
          y: 0,
          duration: 0.4,
          ease: "power2.out",
          onComplete: () => {
            gsap.to(cards, {
              opacity: 1,
              y: 0,
              duration: 0.2,
              stagger: 0.08,
              ease: "power2.out"
            });
          }
        });
      },
      once: true
    });
  });
</script>
